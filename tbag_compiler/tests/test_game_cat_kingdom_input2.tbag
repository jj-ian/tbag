room {}

room Great_Hall {  name = "Great_Hall"; }
room Throne_Room { name = "Throne_Room"; }
room East_Chamber { name = "East_Chamber"; }
room West_Chamber {	name = "West_Chamber"; }
room Kitchen { name = "Kitchen"; }
room Private_Bedroom { name = "Private_Bedroom"; }

Throne_Room <-> Great_Hall;   West_Chamber <-> Great_Hall;
East_Chamber <-> Great_Hall;   West_Chamber <-> Kitchen;

start { Great_Hall }

npc {   int id; string name; string roomName; string message; 
		string goodResponse; string evilResponse;
		string goodResult; string badResult;
}

npc Tubbs {
	id = 0;
	name = "King Tubbs";
	roomName = "East_Chamber";
	message = "hi";
	goodResponse = ""; evilResponse = ""; goodResult = ""; badResult = "";
}

npc Pickles {
	id = 1;
	name = "Duke Pickles";
	roomName = "West_Chamber";
	message = "Your greatness, welcome to the treasury. I am your financial advisor.\n I stand here amongst our hoard of cheese chunks to determine the general \"cheesiness\" of our monarchy.\n Feel free to drop in any time and ask how things are going, yes.\n";
	goodResponse = ""; evilResponse = ""; goodResult = ""; badResult = "";
}

npc Marshmallow {
	id = 2;
	name = "Lady Marshmallow";
	roomName = "East_Chamber";
	message = "Hello, my new and temporary liege. I am your kingdom advisor.\n It is my job to advise you on the health and happiness of your kingdom.\n My own health and happiness is irrelevant.\n Please, see me again some time.\n";
	goodResponse = ""; evilResponse = ""; goodResult = ""; badResult = "";

}

npc Pumpkin {
	id = 3;
	name = "Pumpkin";
	roomName = "Throne_Room";
	message = "Excuse me, monarch, leader...\nI have a humble request...\nWould you be willing...\nTo sing to my stupid cat baby?\n";
	goodResponse = "Sure?\n"; 
	evilResponse = "IT'S MY BABY NOW!\n"; 
	goodResult = "You sing to the baby. It doesn't seem to care all that much.\n"; 
	badResult = "You eventually get bored of the baby and give it to someone else.\n";

}

npc Snowball {
	id = 4;
	name = "Snowball";
	roomName = "Throne_Room";
	message = "A cat baby is lost in the spooky forest!\nI know because it sent me this baby note, via forest squirrel!\n";
	goodResponse = "I will organize a search party!\n";
	evilResponse = "I will organize a snake party!\n";
	goodResult = "They find a baby, and a dozen or so other babies.\n";
	badResult = "You party with some snakes. What a night! The baby is never heard from again.\n";
}

npc Patches {
	id = 5;
	name = "Patches";
	roomName = "Throne_Room";
	message = "The library is underfunded and at risk of closing down.\nMight your royal-ness be willing to sponsor us?\n";
	goodResponse = "Yes, I LOVE BOOKS!\n";
	evilResponse = "PSH, READING?! PSHHH!!";
	goodResult = "The library was saved! Also, it's haunted by dark spirits.\n";
	badResult = "Every book was burned. The librarians cried for days.\n";

}
/* son, lonely, forest baby*/
/*
npc Smokey {
	id = 6;
	name = "Smokey";
	roomName = "Throne_Room";
	message = "Please, my house is ?\n";
	goodResponse = "Yes, I LOVE BOOKS!\n";
	evilResponse = "PSH, READING?! PSHHH!!";
	goodResult = "The library was saved! Also, it's haunted by dark spirits.\n";
	badResult = "Every book was burned. The librarians cried for days.\n";
}

npc Ginger {

}*/
/* the peasants are miserable. but most of them aren't dead, so at least thats something*/
/*look at this hoard! this delicious cheesy hoard!*/

item {
	int initialAmount;
}

item BowlX {
	initialAmount = 5;
}

item BowlY {
	initialAmount = 7;
}

item BowlZ {
	initialAmount = 8;
}

/* to easily access the db */

string[10] catNames;
string[10] catRoomNames;
string[10] catMessages;
string[10] goodResponses;
string[10] evilResponses;
string[10] goodResults;
string[10] badResults;

string[5] requestTitleCard;


boolean started = false;
int week = 1;
boolean spokeToMarshmallow = false;
boolean spokeToPickles = false;
boolean rollOverWeek = true;
int stateOfKingdom = 5;
int cheeseCubeCount = 5;
int lengthSabbatical = 3;

boolean handleSubjects = false;

boolean dataInitialized = false;

boolean xyzPuzzleInProgress = false;
int bowlXAmount;   
int bowlYAmount;   
int bowlZAmount;


int xyzState = 1;

NOT dataInitialized {
	
	catNames[0] = Tubbs.name; catNames[1] = Pickles.name; catNames[2] = Marshmallow.name; 
	catNames[3] = Pumpkin.name; catNames[4] = Snowball.name; catNames[5] = Patches.name;


	catRoomNames[0] = Tubbs.roomName; catRoomNames[1] = Pickles.roomName; 
	catRoomNames[2] = Marshmallow.roomName; catRoomNames[3] = Pumpkin.roomName; 
	catRoomNames[4] = Snowball.roomName; catRoomNames[5] = Patches.roomName;


	catMessages[0] = Tubbs.message; catMessages[1] = Pickles.message; 
	catMessages[2] = Marshmallow.message; catMessages[3] = Pumpkin.message; 
	catMessages[4] = Snowball.message; catMessages[5] = Patches.message;

goodResponses[0] = Tubbs.goodResponse; goodResponses[1] = Pickles.goodResponse; 
goodResponses[2] = Marshmallow.goodResponse; goodResponses[3] = Pumpkin.goodResponse; 
goodResponses[4] = Snowball.goodResponse; goodResponses[5] = Patches.goodResponse; 

evilResponses[0] = Tubbs.evilResponse; evilResponses[1] = Pickles.evilResponse; 
evilResponses[2] = Marshmallow.evilResponse; evilResponses[3] = Pumpkin.evilResponse; 
evilResponses[4] = Snowball.evilResponse; evilResponses[5] = Patches.evilResponse; 

goodResults[0] = Tubbs.goodResult; goodResults[1] = Pickles.goodResult; 
goodResults[2] = Marshmallow.goodResult; goodResults[3] = Pumpkin.goodResult; 
goodResults[4] = Snowball.goodResult; goodResults[5] = Patches.goodResult; 

badResults[0] = Tubbs.badResult; badResults[1] = Pickles.badResult; 
badResults[2] = Marshmallow.badResult; badResults[3] = Pumpkin.badResult; 
badResults[4] = Snowball.badResult; badResults[5] = Patches.badResult; 

requestTitleCard[1] = "YOUR CAT SUBJECTS HAVE SOME IMPORTANT REQUESTS!\n\n"; 
requestTitleCard[2] = "YOUR CAT SUBJECTS HAVE EVEN MORE REQUESTS!\n\n";
requestTitleCard[3] = "BIG DECISIONS ON BIG REQUESTS, HERE THEY COME, GET READY!\n\n";

bowlXAmount = BowlX.initialAmount;  
bowlYAmount = BowlY.initialAmount;  
bowlZAmount = BowlZ.initialAmount;

dataInitialized = true;

}

NOT started {
	strPrintLine("King Tubbs, the great monarch of the Cat Kingdom, has recently discovered a sunbeam of sensational quality!");
	print("He has, understandably, requested a ");
	print(lengthSabbatical);
	strPrintLine(" week sabbatical.");
	strPrintLine("It is up to you (as an Official Visiting Noblecat) to lead the kingdom during that time.");
	strPrintLine("Speak to your advisors and then make some important decisions!");
	strPrintLine("At the end of seven weeks you can see exactly what sort of ruler you have been.");
	strPrintLine("THE CAT MONARCHY AWAITS YOUR STEADY LEADERSHIP!\n\n");
	started = true;
}

rollOverWeek {
	/*
		print("stateOfKingdom ");
	intPrintLine(stateOfKingdom);

	week = week + 1;
	handleSubjects = false;
	->Great_Hall*/

	print("----------------------  WEEK ");   print(week);  
	strPrintLine(" ----------------------\n\n");
	rollOverWeek = false;

}

currentRoom.name ~~ Pickles.roomName {
	print("Ah, here is your financial advisor ");
	print(Pickles.name);
	strPrintLine("!");
	strPrintLine("Do you want to talk to him?");
	getInputFromOptions("Yes", "No");
	
	
}

currentRoom.name ~~ Pickles.roomName AND input ~~ "Yes" {
	print(Pickles.name);
	strPrintLine(" says: ");
	strPrintLine(Pickles.message);	
	spokeToPickles = true;
}

currentRoom.name ~~ Marshmallow.roomName {
	print("In this room is your kingdom advisor ");
	print(Marshmallow.name);
	strPrintLine("!");
	strPrintLine("Do you want to talk to her?");
	getInputFromOptions("Yes", "No");
	
}

currentRoom.name ~~ Marshmallow.roomName AND input ~~ "Yes" {
	print(Marshmallow.name);
	strPrintLine(" says: ");
	strPrintLine(Marshmallow.message);
	spokeToMarshmallow = true;
}
NOT xyzPuzzleInProgress {
	printCurrentRoomInfo();
		getInputAdjacentRooms(currentRoom);

}

NOT xyzPuzzleInProgress AND NOT (input ~~ Throne_Room.name) {
	->input	
}

input ~~ Throne_Room.name {
	if (spokeToMarshmallow AND spokeToPickles) {
		-> input
	} else {
		strPrintLine("Before heading to the throne room to make today's BIG DECISIONS, you should consider talking to your advisors to the east and west!");
	}	
}

currentRoom == Throne_Room {
	print(requestTitleCard[week]);
	handleSubjects = true;

}

handleSubjects {
	int subjectID = arbitrarySubjectID();
	strPrintLine(catMessages[subjectID]);
	print("1.  ");
	print(goodResponses[subjectID]);
	print("2.  ");
	strPrintLine(evilResponses[subjectID]);

	getInputFromOptions("1", "2");

	if (input ~~ "1") {
		strPrintLine(goodResults[subjectID]);
		stateOfKingdom = stateOfKingdom + 1;
		cheeseCubeCount = cheeseCubeCount - 1;
	} else {
		strPrintLine(badResults[subjectID]);
		stateOfKingdom = stateOfKingdom - 1;
		cheeseCubeCount = cheeseCubeCount + 1;
	}

	print("stateOfKingdom ");
	intPrintLine(stateOfKingdom);

	->Great_Hall

	week = week + 1;
	handleSubjects = false;
	rollOverWeek = true;
}

currentRoom == Kitchen AND NOT xyzPuzzleInProgress {
	strPrintLine("You see three bowls of cat food, one labeled \"X\", one labeled \"Y\", and one labeled \"Z\".");
	xyzPuzzleInProgress = true;
}

xyzPuzzleInProgress {
	strPrintLine("Which bowl do you want to eat from?");
		getInputFromOptions("X", "Y", "Z", "None");
}

currentRoom == Kitchen AND xyzPuzzleInProgress AND input ~~ "None" {
	strPrintLine("exxited puzzle");
	xyzState = 1;
	xyzPuzzleInProgress = false;
}
/*
xyzPuzzleInProgress AND xyzState == 1 AND input ~~ "X" {
	strPrintLine("going to state 2");
	xyzState = 2;
}

xyzPuzzleInProgress AND xyzState == 2 AND input ~~ "Y" {
		strPrintLine("going to state 3");

	xyzState = 3;
}

xyzPuzzleInProgress AND xyzState == 3 AND input ~~ "Z" {
		strPrintLine("going to state 4");

	xyzState = 4;
}

xyzPuzzleInProgress AND xyzState == 4 AND input ~~ "Z" {
		strPrintLine("going to state 5");

	xyzState = 5;
}

xyzPuzzleInProgress AND xyzState == 5 AND input ~~ "Y" {
		strPrintLine("going to state 6");

	xyzState = 6;
}*/


xyzPuzzleInProgress AND input ~~ "X" {
	if (bowlXAmount > 0) {
		bowlXAmount = bowlXAmount - 1;
		print("Bowl X has ");   print(bowlXAmount);   print(" foods left.\n\n");
		if (xyzState == 1) { 
			strPrintLine("going to state 2");
			xyzState = 2;
		} else { 
			strPrintLine("going to state 1");

			xyzState = 1;
		}
	} else {
		strPrintLine("There's no food left in this bowl.")
	}
}

xyzPuzzleInProgress AND input ~~ "Y" {
	if (bowlYAmount > 0 ) {
		bowlYAmount = bowlYAmount - 1;
		print("Bowl Y has ");   print(bowlYAmount);   print(" foods left.\n\n");

		if (xyzState == 2) { 
			strPrintLine("going to state 3");
			xyzState = 3;
		} else { 
			if (xyzState == 5) {
				strPrintLine("going to state 5");
				xyzState = 6;
			} else { 	
				strPrintLine("going to state 1");
				xyzState = 1;}
			}
		} else {
			strPrintLine("There's no food left in this bowl.")

		}


	}

	xyzPuzzleInProgress AND input ~~ "Z" {
		if (bowlZAmount > 0) {
			bowlZAmount = bowlZAmount - 1;
			print("Bowl Z has ");   print(bowlZAmount);   print(" foods left.");

			if (xyzState == 3) { 
				strPrintLine("going to state 4");
				xyzState = 4;
			} else { 
				if (xyzState == 4) {
					strPrintLine("going to state 5");
					xyzState = 5;
				} else {
					strPrintLine("going to state 1");

					xyzState = 1;
				}
			}
		} else {
			strPrintLine("There's no food left in this bowl.")

		}

}
xyzPuzzleInProgress AND xyzState == 6 {
	strPrintLine("You found a secret trap door!! In it you find a stash of 9,999 cheese cubes!!");
	cheeseCubeCount = cheeseCubeCount + 9999;
	xyzState = 1;
}


week > lengthSabbatical {
	print("todo endgame stuff\n");

	endgame;
}

#import stdlib

func void printCurrentRoomInfo() {
	print("You're in the ");
	print(currentRoom.name);
	strPrintLine(".\n");
}

func string picklesMessages(int cheeseCubes) {
	if (cheeseCubes < 2) {
		return "";
	} else {}
	return "";
}


func int arbitrarySubjectID() {
	/*
	int a = stateOfKingdom * 7;
	int b = a/11;
	int result = a -b;
		print("stateofkingdom ");
	intPrintLine(stateOfKingdom);
	print("random number ");
	intPrintLine(result);
	return result;*/
	if (week == 1) { return 3; } else {}
	if (week == 2) { return 5; } else {}
	if (week == 3) { return 4; } else {}
	return neg 1;



}



